# LD-Notion 使用教程

我写这篇教程的时候尽量把每一步都说清楚了，跟着做就行。

## 这东西是干啥的

我平时在 Linux.do 上看到好帖子就随手收藏，时间一长收藏夹里攒了一大堆。想整理到 Notion 里，但一个个复制粘贴太累了，格式还全丢了。

所以就有了这个脚本，主要干两件事：

**批量导帖子**。你在 Linux.do 收藏的帖子，可以一键全部导到 Notion 里。代码块、表格、图片、引用这些格式都会保留，不是那种纯文本粘贴。

**AI 助手**。装完脚本之后，Linux.do 和 Notion 两个站点上都会多一个 AI 对话框，你可以用普通话让它帮你管理 Notion。比如"帮我搜一下关于 Docker 的笔记"、"把没分类的文章都归个类"之类的。

这两个功能互相独立，你只用其中一个也完全OK。

---

## 怎么装

### 先装 Tampermonkey

这是个浏览器插件，用来运行用户脚本。你可能已经装了，没装的话去对应的商店搜 "Tampermonkey" 安装就行：

- [Chrome 商店](https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo)
- [Firefox 商店](https://addons.mozilla.org/en-US/firefox/addon/tampermonkey/)
- [Edge 商店](https://microsoftedge.microsoft.com/addons/detail/tampermonkey/iikmkjmpaadaobahmlepeloendndfphd)

装好之后浏览器右上角会多一个图标。

<!-- 📸 浏览器右上角 Tampermonkey 图标 -->

### 装脚本

点 Tampermonkey 图标 → 添加新脚本 → 把编辑器里的默认内容清掉 → 把 `LinuxDo-Bookmarks-to-Notion.user.js` 的内容全部粘贴进去 → Ctrl+S 保存。

<!-- 📸 Tampermonkey 编辑器，粘贴好脚本的样子 -->

回到 Tampermonkey 管理页面看一眼，能看到 LD-Notion 是开启状态就对了。

<!-- 📸 Tampermonkey 管理面板，脚本已启用 -->

---

## Notion 那边的准备工作

这步有点烦但只用搞一次，后面就不用管了。

### 创建 Integration

Notion 要求你创建一个 "Integration" 才能让外部程序访问你的数据。

打开 [Notion Integrations](https://www.notion.so/my-integrations)，点 New integration，随便取个名字（我取的 "LD-Notion"），选你的工作区。

重点是 Capabilities 那里，这三个必须勾上：
- Read content
- Update content
- Insert content

<!-- 📸 创建 Integration 的页面 -->

提交之后会生成一个 Token，`secret_` 开头的一长串，复制保存好。这个就是 Notion API Key，后面要用。

<!-- 📸 Token 生成后的页面 -->

### 建个数据库

在 Notion 里随便建一个数据库就行，用来存导入的帖子。

要加这些列：

| 列名 | 类型 | 说明 |
|------|------|------|
| 标题 | Title | 默认就有，改个名 |
| 链接 | URL | 原帖地址 |
| 分类 | Text | 帖子分类 |
| 标签 | Multi-select | 帖子标签 |
| 作者 | Text | 谁发的 |
| 收藏时间 | Date | 啥时候收藏的 |
| 帖子数 | Number | 回帖数 |
| 浏览数 | Number | 多少人看了 |
| 点赞数 | Number | 点赞 |

嫌麻烦的话也不用手动建，后面面板上有个 "自动设置数据库" 按钮，点一下就给你建好了。

<!-- 📸 Notion 数据库，建好的列 -->

### 关联 Integration（很多人忘这步）

打开刚建的数据库 → 右上角 `...` → Connections → 把你刚创建的 Integration 加进去。

<!-- 📸 数据库连接 Integration -->

这步不做的话脚本是读不到你的数据库的，会一直报错。

### 拿数据库 ID

看浏览器地址栏，格式大概是：
```
https://www.notion.so/xxx/这里32位就是ID?v=xxx
```

把中间那串 32 位的字母数字复制下来。不过其实你也可以不手动复制，面板上有个刷新按钮能自动列出你所有的数据库，下拉选一个就行。

---

## 开始导帖子

### 打开你的收藏页面

地址是 `https://linux.do/u/你的用户名/activity/bookmarks`

打开之后右边会冒出来一个深蓝色面板，写着 "📚 收藏导出到 Notion"。

<!-- 📸 Linux.do 收藏页右侧面板 -->

没出来的话看看 Tampermonkey 里脚本是不是开着。

### 填配置

面板上面填两样东西：

1. API Key — 就是前面那个 `secret_` 开头的
2. 数据库 ID — 粘贴 32 位 ID 或者点 🔄 从列表里选

<!-- 📸 填好配置的面板 -->

填完点 **验证配置**，绿了就OK。

头一次用的话顺便点下 **自动设置数据库**，帮你把缺的列自动建好。

### 加载和导出

点 **🔄 加载收藏列表**，等它拉取完。出来一个列表，每个帖子前面有勾选框，默认全选。不想导的取消勾选就行。

<!-- 📸 收藏列表 -->

然后点 **📤 开始导出**。导的时候有进度显示，能看到在导哪一个。

<!-- 📸 导出进度 -->

中途可以暂停，也可以取消。导完会出一份报告告诉你结果。

<!-- 📸 导出报告 -->

去 Notion 看看，帖子都在里面了，格式什么的都还在。

<!-- 📸 Notion 里导入的帖子 -->

---

## 筛选设置

点面板上的 **筛选设置** 能展开更多选项。

**仅主楼** — 只导正文不导回帖。大部分时候我勾这个就够了。

**仅楼主** — 只导楼主的内容，别人的回复跳过。

**楼层范围** — 比如 1 到 10 就只导前十楼。

**图片处理** — 三种：
- 上传到 Notion：最靠谱但慢
- 外链引用：快但原图没了就没了
- 跳过图片：最快，只要文字

**请求间隔** — 调小能快点，但太快 Notion 会限速。脚本碰到限速会自己重试，问题不大。

**并发数** — 默认一个一个导，开到 3 或 5 能快很多。

<!-- 📸 筛选设置展开 -->

**导出目标** 有两种选择：
- 数据库：帖子变成数据库里的条目，能排序能筛选，推荐
- 页面：帖子变成子页面挂在一个父页面下面，适合搞树状笔记

---

## 自动导入

不想每次手动导的话，可以勾上 **启用自动导入新收藏**。

<!-- 📸 自动导入设置 -->

勾上之后选一个轮询间隔（3/5/10/30 分钟），脚本就会定时检查你有没有新收藏，有就自动导过去。导过的不会重复导。

注意收藏页面得保持打开，可以扔后台标签页里。关了页面就不会自动导了。

---

## AI 助手

我觉得这个功能挺有意思的，虽然不是所有人都需要。

### 配 AI

面板里往下拉，找到 **🤖 AI 助手**，展开 **⚙️ AI 设置**。

<!-- 📸 AI 设置 -->

要填这些：

**AI 服务** — 看你有哪家的 Key，OpenAI / Claude / Gemini 选一个。

**模型** — 选好服务之后点 🔄 能自动拉可用的模型列表。

**API Key** — 注意这个是 AI 服务的 Key，不是 Notion 的那个，别搞混。

**自定义端点** — 用第三方代理的在这填地址，用官方 API 的留空就行。

**分类列表** — 给自动分类功能用的，逗号分隔，默认是 "技术, 生活, 问答, 分享, 资源, 其他"，随便改。

**查询数据库** — AI 查数据的范围。可以只查当前配置的库，也可以查所有库，或者点 🔄 指定某个库。

**刷新页数上限** — 点刷新按钮获取工作区列表时最多拉几页数据，默认 10 页 (1000 条)，工作区内容特别多的可以调高，或者选无限制。

填完点 **测试连接** 试一下。

### 怎么用

直接在对话框里打字，说人话：

```
搜索关于 Docker 的帖子
```

```
统计一下各分类有多少文章
```

```
帮我把没分类的文章自动分类一下
```

```
创建一个叫"学习笔记"的数据库
```

```
把这篇文章翻译成英文
```

```
我的笔记里有关于 K8s 的内容吗
```

AI 会自己判断该用什么工具，复杂的任务它会自动拆成几步来做。比如你让它"统计各分类的文章数量"，它会先看数据库结构，再查数据，最后给你汇总。

<!-- 📸 一段 AI 对话 -->

具体来说它有 11 个工具可以调用：

| 你说的话 | 它干的事 |
|---------|---------|
| 搜索 xxx | 在工作区里搜页面和数据库 |
| 查一下 xxx | 带条件查询数据库 |
| 这个页面写了什么 | 读取页面内容 |
| 数据库有哪些列 | 看数据库结构 |
| 追加内容到页面 | 往页面后面写东西 |
| 改一下标题/属性 | 更新页面属性 |
| 新建一个 xxx | 在数据库里建新页面 |
| 自动分类 | 批量给文章分类 |
| 移动到 xxx | 把页面搬到另一个库 |
| 复制到 xxx | 复制页面 |
| 建个新数据库 | 创建数据库 |

不知道说啥的话直接输入 `帮助` 它会告诉你。

---

## Notion 站点上的 AI

装了脚本之后，打开 Notion 页面右下角会多一个 🤖 按钮。

<!-- 📸 Notion 右下角浮动按钮 -->

点开就是一个 AI 面板，功能跟 Linux.do 那边完全一样，配置也是通的，改一边另一边会同步。

<!-- 📸 Notion AI 面板 -->

面板里的设置展开之后有：
- Notion API Key
- 数据库/页面选择器（点 🔄 刷新，下拉框里 📁 是数据库 📄 是页面）
- AI 服务和模型配置

面板和按钮都能拖拽，拖到哪下次打开还在那。

---

## 权限

面板上 Notion 配置区域底部有几个安全相关的设置。

**权限级别** 四档：

| 级别 | 能干啥 |
|------|--------|
| 只读 | 只能搜和看 |
| 标准 | 能建页面、改属性、写内容、自动分类 |
| 高级 | 能移动/复制页面、建数据库 |
| 管理员 | 啥都能干 |

平时用"标准"就够了，要移动页面的时候切成"高级"。

**危险操作确认** — 开着的话移动删除之类的操作会先问你一下。建议别关。

**审计日志** — 记录 AI 都干了啥，面板底部 📋 操作日志 里能看到。

<!-- 📸 权限设置 + 操作日志 -->

---

## 常见问题

**验证配置一直失败**

大概率是这三个原因之一：Key 没复制完整（得 `secret_` 开头）、数据库 ID 不对（32 位字母数字不是整个网址）、Integration 没关联到数据库。

**图片看不到**

外链模式的话原图没了就没了。换成 "上传到 Notion" 重新导一次。有些图需要登录才能看，Notion 抓不到也正常。

**导出太慢了**

并发调到 3 或 5，请求间隔调到 200ms，图片选跳过或外链。碰到 429 报错不用管，脚本会自己等一会再试。

**AI 不好使**

检查一下：AI 的 Key 和 Notion 的 Key 是两个东西别用混了；OpenAI 的 Key 就选 OpenAI 服务，别选成 Claude；自定义端点填的地址要能访问。

**想重新导已经导过的帖子**

F12 打开控制台跑一行：
```javascript
GM_setValue("ldb_exported_topics", "{}")
```
这样就清掉导出记录了。

---

## 小技巧

1. 第一次别全导，先选几个试试。确认没问题再批量搞。

2. 大部分人用数据库模式就行，能排序筛选挺方便的。想搞树状笔记的再用页面模式。

3. 不知道 AI 能干啥，打 `帮助` 两个字。

4. 面板挡事了点右上角 `−` 最小化，会变成一个小图标。

5. 嫌手动建数据库列麻烦，填好 Key 和 ID 之后直接点 **自动设置数据库**。

---

有问题或者想提建议可以去 [GitHub Issues](https://github.com/Smith-106/LD-Notion/issues) 说。
